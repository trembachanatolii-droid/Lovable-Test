- name: Upload dist â†’ Hostinger (FTPS mirror)
  env:
    HOST: ${{ secrets.HOSTINGER_HOST }}
    USER: ${{ secrets.HOSTINGER_USER }}
    PASS: ${{ secrets.HOSTINGER_PASS }}
    PORT: ${{ secrets.HOSTINGER_PORT }}
    DIR:  ${{ secrets.HOSTINGER_DIR }}
  run: |
    set -euo pipefail
    sudo apt-get update && sudo apt-get install -y lftp

    # Default to the current directory (.) if DIR is blank
    if [ -z "$DIR" ]; then DIR="."; fi

    # The key lftp settings:
    lftp -c "
      set ftp:passive-mode yes;
      set ftp:ssl-allow yes;
      set ftp:ssl-force true;
      set ftp:ssl-protect-data true;
      set ssl:verify-certificate no;
      set net:timeout 30;
      set net:max-retries 2;
      open -p $PORT ftps://$HOST;
      user \"$USER\" \"$PASS\";
      cd $DIR;
      put dist/deploy.txt -o deploy.txt;
      mirror -R --delete --verbose dist .;
      quit;
    "
